This daemon application was developed for a demonstration purpose only.

To enable loading by a systemd put secure-debug-access.service file into lib/systemd/system
and then invoke systemctl enable secure-debug-access.service

Current setup requires launching the daemon with a command line for simple demonstration.
Console app will configure all required parameters and launch the daemon.
Daemon logs can be found in syslog (tail -f /var/log/syslog).

About the daemon:
The posixdaemon_app is a daemon that is listening a 8080 port of a local device,
expecting for incoming token messages. Token messages are expected to be generated by
a peer application, implementing the same protocol.

For demo purpose it is set that 8080 port is only listening for token requests.
As the result - any incoming connection request will produce a token value:
 - |Invalid| for anything that does not pass authentication;
 - |Debug Off|/|Debug On| request if authentication is passed and correct token value is accepted.


The posixdaemon_app requires 2 files and 3 parameters fo successfull start:
- a path to a peer certificate file (issued for a private key, used by the  peer app
 (1.3.132.0.35 OID - eliptic curve identifier)) to verify a handshake request;
- string password;
- path to a file containing DER-encoded eliptic curve private key, generated for 
  daemon app, encrypted with AES GCM. The AES key derivation: SHA256(<string password>).
  The key is used to sign handshake response.

The peer app requires the same data: a cerificate for a private key, used by daemon,
(to verify handshake response), a EC private key (to sign a handshake request), and
enything else that can be required to operate with private key and certificate data.

Protocol details can be found in source code. 
All ASN.1 structures are defined via OpenSSL macros.
No callbacks (ASN1_OP_D2I_POST/ASN1_OP_NEW_POST, etc..) were implemented.
Only predefined standard structures and algorithms were used.
No secure coding libraries were used.
No memory management procedures were made to avoid sensitive data leakage.
No smart pointers were used.

Please find build instructions below.

Building OpenSSL.
1. Go to your working directory: cd <your_dir>

2. Install OpenSSL version 1.1.1d:

   wget https://www.openssl.org/source/openssl-1.1.1d.tar.gz

3. tar xf openssl-1.1.1d.tar.gz

4. cd openssl-1.1.1d

5.  ./config --prefix=/usr/local/ssl --openssldir=/usr/local/ssl -Wl,--enable-new-dtags,-rpath,$(LIBRPATH)

6. make -j4
Now the lated OpenSSL release build is ready.


Building the daemon.
1. cd <your_dir>

2. git clone https://github.com/msopiha-globallogic/DaemonApp.git

3. make
Done.
